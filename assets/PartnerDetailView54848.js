import{n as I,a8 as k,p as E,N as v,F as G,G as z,c as M,a,t as Q,y as l,b as t,w as s,M as U,r as u,al as j,ad as b,L as H,o as J,z as y,a5 as h}from"../index54848.js";import{t as K,_ as O}from"./InputtextWithValidation.vue_vue_type_script_setup_true_lang54848.js";import{c as W,g as w,a as X,u as Y,d as Z}from"./vee-validate54848.js";import{_ as q}from"./InputNumberWithValidation.vue_vue_type_script_setup_true_lang54848.js";import{u as F}from"./usePercentageField54848.js";const ee={class:"flex flex-col gap-4 sticky top-0 z-3 bg-surface-50 -mx-8 px-8 -mt-8 pt-8"},ae={class:"flex justify-between sm:items-center gap-4 sm:flex-row flex-col"},te={class:"flex flex-col gap-2"},se={class:"m-0 text-surface-900 text-xl font-semibold leading-tight"},oe={class:"flex items-center gap-y-4 gap-x-2"},ne={class:"pb-16 mt-4"},le={class:"flex flex-col gap-6"},re={class:"grid grid-cols-12 gap-6"},ie={class:"col-span-12 md:col-span-4"},ce={class:"grid grid-cols-12 gap-6"},de={class:"col-span-12 md:col-span-2"},pe={class:"col-span-12 md:col-span-2"},xe=I({__name:"PartnerDetailView",props:{params:{}},setup(P){const i=P,c=k(),V=j(),{showLoader:S,hideLoader:C}=U(),d=E(!1),A=K(W({name:X().required("Il nome Ã¨ obbligatorio"),cqp_fee:w().nullable(),cqs_fee:w().nullable()})),{resetForm:f,handleSubmit:D,defineField:_}=Y({validationSchema:A,initialValues:{cqp_fee:0,cqs_fee:0}}),[N]=_("cqp_fee"),[$]=_("cqs_fee"),B=Z("name"),p=F(N),m=F($),g=D(async o=>{d.value=!0,await v(async()=>{if(r.value){const e=await c.updatePartner(r.value,o);b("Partner aggiornato"),f({values:{...e}})}else{const e=await c.createPartner(o);b("Partner creato"),await V.replace({name:H.PARTNER_DETAIL,params:{id:e.id}})}},{onFinally:()=>d.value=!1})}),r=G(()=>i.params?.partner_id);async function L(o){S(),await v(async()=>{const e=await c.fetchPartnerDetail(o);f({values:{...e}})},{rethrow:!1,onFinally:C})}return z(()=>{i.params?.partner_id&&L(i.params.partner_id)}),(o,e)=>{const R=u("Button"),x=u("InputGroupAddon"),T=u("Card");return J(),M("form",{class:"flex-1 flex flex-col pt-8 px-8",onSubmit:e[2]||(e[2]=(...n)=>l(g)&&l(g)(...n))},[a("div",ee,[a("div",ae,[a("div",te,[a("h1",se,Q(r.value?`Dettaglio ${l(B)??""}`:"Nuovo partner"),1)]),a("div",oe,[t(R,{label:"Salva",type:"submit",loading:d.value,severity:"primary"},null,8,["loading"])])])]),a("div",ne,[t(T,{class:"pb-4"},{title:s(()=>[...e[3]||(e[3]=[a("h4",null,"Dati partner",-1)])]),content:s(()=>[a("div",le,[a("div",re,[a("div",ie,[t(O,{disabled:!!r.value,id:"name",label:"Nome*",name:"name"},null,8,["disabled"])])]),a("div",ce,[a("div",de,[t(q,{modelValue:l(p),"onUpdate:modelValue":e[0]||(e[0]=n=>y(p)?p.value=n:null),id:"cqp_fee",label:"Fee CQP","max-fraction-digits":2},{prefixAddon:s(()=>[t(x,null,{default:s(()=>[...e[4]||(e[4]=[h("%",-1)])]),_:1})]),_:1},8,["modelValue"])]),a("div",pe,[t(q,{modelValue:l(m),"onUpdate:modelValue":e[1]||(e[1]=n=>y(m)?m.value=n:null),id:"cqs_fee",label:"Fee CQS","max-fraction-digits":2},{prefixAddon:s(()=>[t(x,null,{default:s(()=>[...e[5]||(e[5]=[h("%",-1)])]),_:1})]),_:1},8,["modelValue"])])])])]),_:1})])],32)}}});export{xe as default};
