import{ag as n,ah as $,ai as g,p as q,F as r,aj as w}from"../index54848.js";class o{static async fetchInitialData(){return await n.get("/cqp_practices/init_select")}static async createCqp(t){return await n.post("/cqp_practices",t)}static async fetchCqps(t){return await n.get("/cqp_practices",{params:t})}static async fetchCqpDetail(t){return await n.get(`/cqp_practices/${t}`)}static async updateCqp(t,e){return await n.patch(`/cqp_practices/${t}`,e)}static async checkCfAvailability(t){await n.get(`/cqp_practices/cf_available?cf=${t}`)}static async deleteCqp(t){await n.delete(`/cqp_practices/${t}`)}static async exportCqps(){return(await n.client.get("/cqp_practices/export",{responseType:"blob"})).data}}class p{static async requestPresignedUrl(t){return await n.post("/attachments/request_upload",t)}static async uploadFileToS3(t,e){const m=await e.arrayBuffer(),C=new Uint8Array(m);await new $().put(t,C,{headers:{"Content-Type":e.type,"Content-Length":C.length.toString()}})}static async confirmUploadFile(t){await n.post("/attachments/confirm",{attachment_id:t})}static async deleteAttachment(t){await n.delete(`/attachments/${t}`)}}const k=g("cqp-store",()=>{const a=q(null),t=q(null),e=q(null),m=r(()=>a.value?.cqp_practices),C=r(()=>a.value?.pagination.total??0),f=r(()=>t.value?.cities??[]),v=r(()=>t.value?.countries??[]),h=r(()=>t.value?.provinces??[]),_=r(()=>t.value?.gender??[]),A=r(()=>e.value),i=r(()=>t.value?.questions??[]);async function l(){t.value||(t.value=await o.fetchInitialData())}async function u(c){const s=await o.createCqp(c);return e.value=s,s}async function b(c){return a.value=await o.fetchCqps(c),a.value}async function L(c){return e.value=(await o.fetchCqpDetail(c)).cqp_practice,e.value}async function T(c,s){return e.value=(await o.updateCqp(c,s)).cqp_practice,e.value}async function S(c,s){const{upload_url:d,attachment:P}=await p.requestPresignedUrl({file_name:s.name,mime_type:s.type,entity_type:"CqpPractice",type:"cqp.attachments",entity_id:c,size_bytes:`${s.size}`});await p.uploadFileToS3(d,s),await p.confirmUploadFile(P.id)}async function E(c){await p.deleteAttachment(c)}async function U(c){await o.checkCfAvailability(c)}async function R(c){await o.deleteCqp(c)}async function D(){const c=await o.exportCqps(),s=URL.createObjectURL(c),d=document.createElement("a");d.href=s,d.download="export_cqp.csv",d.click(),URL.revokeObjectURL(s)}function O(){a.value=null,t.value=null}return{paginatedCqps:w(a),initialData:w(t),cqp:w(e),allCqps:m,totalCqps:C,allCities:f,allCountries:v,allProvinces:h,allGenders:_,currentCqp:A,allQuestions:i,fetchInitialData:l,createCqp:u,fetchCqps:b,fetchCqpDetail:L,updateCqp:T,uploadFileAttachment:S,deleteAttachment:E,checkCfAvailability:U,deleteCqp:R,downloadCqpExport:D,$reset:O}}),I=["PROPOSAL","CONTRACT","CANCELLED","TERMINATED","CLAIM"],N={PROPOSAL:"Proposta",CONTRACT:"Contratto",CANCELLED:"Annullato",TERMINATED:"Estinto",CLAIM:"Sinistro"},F={PROPOSAL:"bg-yellow-500",CONTRACT:"bg-blue-500",CANCELLED:"bg-red-500",TERMINATED:"bg-green-500",CLAIM:"bg-orange-500"};class y{static async createClaim(t){return(await n.post("/claims",t)).claim}static async fetchClaimDetail(t){return await n.get(`/claims/${t}`)}static async updateClaim(t,e){return await n.patch(`/claims/${t}`,e)}static async exportClaims(){return(await n.client.get("/claims/export",{responseType:"blob"})).data}static async deleteClaim(t){await n.client.delete(`/claims/${t}`)}}const M=g("claim-store",()=>{const a=q(null),t=r(()=>a.value);async function e(i){return a.value=await y.createClaim(i),a.value}async function m(i){return a.value=(await y.fetchClaimDetail(i)).claim,a.value}async function C(i,l){return a.value=(await y.updateClaim(i,l)).claim,a.value}async function f(i,l){const{upload_url:u,attachment:b}=await p.requestPresignedUrl({file_name:l.name,mime_type:l.type,entity_type:"Claim",type:"claim.attachments",entity_id:i,size_bytes:`${l.size}`});await p.uploadFileToS3(u,l),await p.confirmUploadFile(b.id)}async function v(i){await p.deleteAttachment(i)}async function h(){const i=await y.exportClaims(),l=URL.createObjectURL(i),u=document.createElement("a");u.href=l,u.download="export_claims.csv",u.click(),URL.revokeObjectURL(l)}async function _(i){await y.deleteClaim(i),a.value=null}function A(){a.value=null}return{claim:w(a),currentClaim:t,createClaim:e,fetchClaimDetail:m,updateClaim:C,uploadClaimAttachment:f,deleteClaimAttachment:v,downloadClaimExport:h,deleteClaim:_,$reset:A}});export{F as C,N as a,I as b,M as c,k as u};
